# Vue3 å‰ç«¯ä¸ Spring Boot åç«¯æ¥å£å¯¹æ¥æ–‡æ¡£

## ğŸ“‹ ç›®å½•
1. [æ¥å£åˆ—è¡¨ä¸å‚æ•°](#æ¥å£åˆ—è¡¨ä¸å‚æ•°)
2. [å‰ç«¯ Axios é…ç½®](#å‰ç«¯-axios-é…ç½®)
3. [çŠ¶æ€ç®¡ç† (Pinia)](#çŠ¶æ€ç®¡ç†-pinia)
4. [è·¨åŸŸå¤„ç†](#è·¨åŸŸå¤„ç†)
5. [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†)
6. [æ•°æ®æµè½¬](#æ•°æ®æµè½¬)
7. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

## 1. æ¥å£åˆ—è¡¨ä¸å‚æ•°

### 1.1 ç¡çœ æ•°æ®æ¥å£

#### GET /api/sleep/data
**åŠŸèƒ½**: è·å–æŒ‡å®šç”¨æˆ·å’Œæ—¥æœŸçš„ç¡çœ æ•°æ®

**è¯·æ±‚å‚æ•°**:
```javascript
{
  userId: string,      // ç”¨æˆ·IDï¼Œå¿…å¡«
  dateOfSleep: string  // ç¡çœ æ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DDï¼Œå¿…å¡«
}
```

**å“åº”æ ¼å¼**:
```javascript
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "id": 1,
    "userId": "user001",
    "dateOfSleep": "2024-01-01",
    "totalSleepDuration": 480,    // æ€»ç¡çœ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
    "deepSleepDuration": 90,      // æ·±ç¡æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
    "remSleepDuration": 120,      // REMç¡çœ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
    "sleepScore": 85,             // ç¡çœ è¯„åˆ†
    "processedAt": "2024-01-01T08:00:00"
  }
}
```

**å‰ç«¯è°ƒç”¨ç¤ºä¾‹**:
```javascript
// APIå±‚
export const sleepApi = {
  getSleepData(userId, dateOfSleep) {
    return request.get('/sleep/data', {
      params: { userId, dateOfSleep }
    })
  }
}

// Storeå±‚
const fetchSleepData = async (userId, dateOfSleep) => {
  try {
    loading.value = true
    const response = await sleepApi.getSleepData(userId, dateOfSleep)
    sleepData.value = response.data
    return response.data
  } catch (err) {
    error.value = err.message
    throw err
  } finally {
    loading.value = false
  }
}
```

### 1.2 ç§¯åˆ†æŸ¥è¯¢æ¥å£

#### GET /api/points/current
**åŠŸèƒ½**: è·å–ç”¨æˆ·å½“å‰æ€»ç§¯åˆ†

**è¯·æ±‚å‚æ•°**:
```javascript
{
  userId: string  // ç”¨æˆ·IDï¼Œå¿…å¡«
}
```

**å“åº”æ ¼å¼**:
```javascript
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "userId": "user001",
    "totalPoints": 150,           // æ€»ç§¯åˆ†
    "todayPoints": 20,            // ä»Šæ—¥ç§¯åˆ†
    "lastUpdated": "2024-01-01T08:00:00"
  }
}
```

**å‰ç«¯è°ƒç”¨ç¤ºä¾‹**:
```javascript
// APIå±‚
export const pointsApi = {
  getCurrentPoints(userId) {
    return request.get('/points/current', {
      params: { userId }
    })
  }
}

// Storeå±‚
const fetchCurrentPoints = async (userId) => {
  try {
    const response = await pointsApi.getCurrentPoints(userId)
    currentPoints.value = response.data
    return response.data
  } catch (err) {
    error.value = err.message
    throw err
  }
}
```

### 1.3 AI å¯¹è¯æ¥å£

#### POST /api/ai/chat
**åŠŸèƒ½**: ä¸AIè¿›è¡Œå¤šè½®å¯¹è¯

**è¯·æ±‚å‚æ•°**:
```javascript
{
  userId: string,    // ç”¨æˆ·IDï¼Œå¿…å¡«
  message: string    // ç”¨æˆ·æ¶ˆæ¯ï¼Œå¿…å¡«
}
```

**å“åº”æ ¼å¼**:
```javascript
{
  "code": 200,
  "message": "AIå›å¤ç”ŸæˆæˆåŠŸ",
  "data": "æ ¹æ®æ‚¨çš„ç¡çœ é—®é¢˜ï¼Œæˆ‘å»ºè®®æ‚¨ä¿æŒè§„å¾‹çš„ä½œæ¯æ—¶é—´..."
}
```

**å‰ç«¯è°ƒç”¨ç¤ºä¾‹**:
```javascript
// APIå±‚
export const aiApi = {
  chatWithAI(userId, message) {
    return request.post('/ai/chat', {
      userId,
      message
    })
  }
}

// Storeå±‚
const sendChatMessage = async (userId, message) => {
  try {
    isChatting.value = true
    
    // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°èŠå¤©è®°å½•
    chatMessages.value.push({
      type: 'user',
      content: message,
      timestamp: new Date()
    })
    
    const response = await aiApi.chatWithAI(userId, message)
    const aiResponse = response.data
    
    // æ·»åŠ AIå›å¤åˆ°èŠå¤©è®°å½•
    chatMessages.value.push({
      type: 'ai',
      content: aiResponse,
      timestamp: new Date()
    })
    
    return aiResponse
  } catch (err) {
    error.value = err.message
    throw err
  } finally {
    isChatting.value = false
  }
}
```

### 1.4 AI æŠ¥å‘Šç”Ÿæˆæ¥å£

#### POST /api/ai/report
**åŠŸèƒ½**: åŸºäºç¡çœ æ•°æ®ç”ŸæˆAIåˆ†ææŠ¥å‘Š

**è¯·æ±‚å‚æ•°**:
```javascript
{
  userId: string,        // ç”¨æˆ·IDï¼Œå¿…å¡«
  dateOfSleep: string    // ç¡çœ æ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DDï¼Œå¿…å¡«
}
```

**å“åº”æ ¼å¼**:
```javascript
{
  "code": 200,
  "message": "AIç¡çœ æŠ¥å‘Šç”ŸæˆæˆåŠŸ",
  "data": "ã€ç¡çœ åˆ†ææŠ¥å‘Šã€‘\n\nã€ä¼˜åŠ¿ã€‘\næ‚¨çš„ç¡çœ è´¨é‡æ•´ä½“è‰¯å¥½...\n\nã€ä¸è¶³ã€‘\næ€»ç¡çœ æ—¶é•¿ç•¥é•¿...\n\nã€å»ºè®®ã€‘\n1. é€‚å½“ç¼©çŸ­ç¡çœ æ—¶é—´..."
}
```

**å‰ç«¯è°ƒç”¨ç¤ºä¾‹**:
```javascript
// APIå±‚
export const aiApi = {
  generateSleepReport(userId, dateOfSleep) {
    return request.post('/ai/report', {
      userId,
      dateOfSleep
    })
  }
}

// Storeå±‚
const generateSleepReport = async (userId, dateOfSleep) => {
  try {
    isGeneratingReport.value = true
    const response = await aiApi.generateSleepReport(userId, dateOfSleep)
    aiReport.value = response.data
    return response.data
  } catch (err) {
    error.value = err.message
    throw err
  } finally {
    isGeneratingReport.value = false
  }
}
```

## 2. å‰ç«¯ Axios é…ç½®

### 2.1 åŸºç¡€é…ç½®

```javascript
// src/utils/request.js
import axios from 'axios'
import { ElMessage } from 'element-plus'

// åˆ›å»ºaxioså®ä¾‹
const request = axios.create({
  baseURL: '/api',                    // åŸºç¡€è·¯å¾„
  timeout: 10000,                     // è¯·æ±‚è¶…æ—¶æ—¶é—´
  headers: {
    'Content-Type': 'application/json', // é»˜è®¤è¯·æ±‚å¤´
  },
})

export default request
```

### 2.2 è¯·æ±‚æ‹¦æˆªå™¨

```javascript
// è¯·æ±‚æ‹¦æˆªå™¨
request.interceptors.request.use(
  (config) => {
    // åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ
    console.log('å‘é€è¯·æ±‚:', config.url)
    
    // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ è®¤è¯token
    // const token = localStorage.getItem('token')
    // if (token) {
    //   config.headers.Authorization = `Bearer ${token}`
    // }
    
    return config
  },
  (error) => {
    console.error('è¯·æ±‚é”™è¯¯:', error)
    return Promise.reject(error)
  }
)
```

### 2.3 å“åº”æ‹¦æˆªå™¨

```javascript
// å“åº”æ‹¦æˆªå™¨
request.interceptors.response.use(
  (response) => {
    const { data } = response
    
    // ç»Ÿä¸€å¤„ç†å“åº”æ ¼å¼
    if (data.code === 200) {
      return data
    } else {
      ElMessage.error(data.message || 'è¯·æ±‚å¤±è´¥')
      return Promise.reject(new Error(data.message || 'è¯·æ±‚å¤±è´¥'))
    }
  },
  (error) => {
    console.error('å“åº”é”™è¯¯:', error)
    
    let message = 'ç½‘ç»œé”™è¯¯'
    if (error.response) {
      switch (error.response.status) {
        case 400:
          message = 'è¯·æ±‚å‚æ•°é”™è¯¯'
          break
        case 401:
          message = 'æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•'
          break
        case 403:
          message = 'æ‹’ç»è®¿é—®'
          break
        case 404:
          message = 'è¯·æ±‚èµ„æºä¸å­˜åœ¨'
          break
        case 500:
          message = 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'
          break
        default:
          message = `è¿æ¥é”™è¯¯${error.response.status}`
      }
    } else if (error.code === 'ECONNABORTED') {
      message = 'è¯·æ±‚è¶…æ—¶'
    }
    
    ElMessage.error(message)
    return Promise.reject(error)
  }
)
```

## 3. çŠ¶æ€ç®¡ç† (Pinia)

### 3.1 ç¡çœ æ•°æ®çŠ¶æ€ç®¡ç†

```javascript
// src/stores/sleep.js
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import { sleepApi } from '@/api/sleep'

export const useSleepStore = defineStore('sleep', () => {
  // çŠ¶æ€
  const sleepData = ref(null)
  const sleepHistory = ref([])
  const loading = ref(false)
  const error = ref(null)

  // è®¡ç®—å±æ€§
  const hasSleepData = computed(() => sleepData.value !== null)
  const sleepScore = computed(() => sleepData.value?.sleepScore || 0)
  const totalSleepDuration = computed(() => sleepData.value?.totalSleepDuration || 0)
  const deepSleepDuration = computed(() => sleepData.value?.deepSleepDuration || 0)
  const deepSleepPercentage = computed(() => {
    if (totalSleepDuration.value === 0) return 0
    return Math.round((deepSleepDuration.value / totalSleepDuration.value) * 100)
  })

  // åŠ¨ä½œ
  const fetchSleepData = async (userId, dateOfSleep) => {
    try {
      loading.value = true
      error.value = null
      const response = await sleepApi.getSleepData(userId, dateOfSleep)
      sleepData.value = response.data
      return response.data
    } catch (err) {
      error.value = err.message
      throw err
    } finally {
      loading.value = false
    }
  }

  const clearData = () => {
    sleepData.value = null
    sleepHistory.value = []
    error.value = null
  }

  return {
    // çŠ¶æ€
    sleepData,
    sleepHistory,
    loading,
    error,
    // è®¡ç®—å±æ€§
    hasSleepData,
    sleepScore,
    totalSleepDuration,
    deepSleepDuration,
    deepSleepPercentage,
    // æ–¹æ³•
    fetchSleepData,
    clearData,
  }
})
```

### 3.2 ç§¯åˆ†çŠ¶æ€ç®¡ç†

```javascript
// src/stores/points.js
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import { pointsApi } from '@/api/points'

export const usePointsStore = defineStore('points', () => {
  // çŠ¶æ€
  const currentPoints = ref(0)
  const pointsHistory = ref([])
  const loading = ref(false)
  const error = ref(null)

  // è®¡ç®—å±æ€§
  const hasPoints = computed(() => currentPoints.value > 0)
  const pointsLevel = computed(() => {
    if (currentPoints.value >= 1000) return { level: 'é’»çŸ³', color: 'text-blue-600' }
    if (currentPoints.value >= 500) return { level: 'é»„é‡‘', color: 'text-yellow-600' }
    if (currentPoints.value >= 200) return { level: 'ç™½é“¶', color: 'text-gray-600' }
    return { level: 'é’é“œ', color: 'text-orange-600' }
  })

  // åŠ¨ä½œ
  const fetchCurrentPoints = async (userId) => {
    try {
      loading.value = true
      error.value = null
      const response = await pointsApi.getCurrentPoints(userId)
      currentPoints.value = response.data.totalPoints
      return response.data
    } catch (err) {
      error.value = err.message
      throw err
    } finally {
      loading.value = false
    }
  }

  const clearData = () => {
    currentPoints.value = 0
    pointsHistory.value = []
    error.value = null
  }

  return {
    // çŠ¶æ€
    currentPoints,
    pointsHistory,
    loading,
    error,
    // è®¡ç®—å±æ€§
    hasPoints,
    pointsLevel,
    // æ–¹æ³•
    fetchCurrentPoints,
    clearData,
  }
})
```

### 3.3 AI å¯¹è¯çŠ¶æ€ç®¡ç†

```javascript
// src/stores/ai.js
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import { aiApi } from '@/api/ai'

export const useAIStore = defineStore('ai', () => {
  // çŠ¶æ€
  const aiReport = ref('')
  const chatMessages = ref([])
  const isGeneratingReport = ref(false)
  const isChatting = ref(false)
  const error = ref(null)

  // è®¡ç®—å±æ€§
  const hasAIReport = computed(() => aiReport.value !== '')
  const hasChatMessages = computed(() => chatMessages.value.length > 0)
  const lastChatMessage = computed(() => {
    return chatMessages.value.length > 0 
      ? chatMessages.value[chatMessages.value.length - 1] 
      : null
  })

  // åŠ¨ä½œ
  const generateSleepReport = async (userId, dateOfSleep) => {
    try {
      isGeneratingReport.value = true
      error.value = null
      const response = await aiApi.generateSleepReport(userId, dateOfSleep)
      aiReport.value = response.data
      return response.data
    } catch (err) {
      error.value = err.message
      throw err
    } finally {
      isGeneratingReport.value = false
    }
  }

  const sendChatMessage = async (userId, message) => {
    try {
      isChatting.value = true
      error.value = null
      
      // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
      chatMessages.value.push({
        type: 'user',
        content: message,
        timestamp: new Date()
      })
      
      const response = await aiApi.chatWithAI(userId, message)
      const aiResponse = response.data
      
      // æ·»åŠ AIå›å¤
      chatMessages.value.push({
        type: 'ai',
        content: aiResponse,
        timestamp: new Date()
      })
      
      return aiResponse
    } catch (err) {
      error.value = err.message
      throw err
    } finally {
      isChatting.value = false
    }
  }

  const clearChatHistory = async (userId) => {
    try {
      await aiApi.clearChatHistory(userId)
      chatMessages.value = []
      return true
    } catch (err) {
      error.value = err.message
      throw err
    }
  }

  const clearData = () => {
    aiReport.value = ''
    chatMessages.value = []
    error.value = null
  }

  return {
    // çŠ¶æ€
    aiReport,
    chatMessages,
    isGeneratingReport,
    isChatting,
    error,
    // è®¡ç®—å±æ€§
    hasAIReport,
    hasChatMessages,
    lastChatMessage,
    // æ–¹æ³•
    generateSleepReport,
    sendChatMessage,
    clearChatHistory,
    clearData,
  }
})
```

### 3.4 ç”¨æˆ·çŠ¶æ€ç®¡ç†

```javascript
// src/stores/user.js
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'

export const useUserStore = defineStore('user', () => {
  // çŠ¶æ€
  const currentUser = ref({
    userId: 'user001',
    username: 'ç¡çœ ç”¨æˆ·',
    avatar: null,
    lastLoginTime: null
  })
  const isLoggedIn = ref(true)

  // è®¡ç®—å±æ€§
  const userDisplayName = computed(() => 
    currentUser.value.username || currentUser.value.userId
  )

  // åŠ¨ä½œ
  const setCurrentUser = (user) => {
    currentUser.value = { ...currentUser.value, ...user }
  }

  const logout = () => {
    currentUser.value = {
      userId: '',
      username: '',
      avatar: null,
      lastLoginTime: null
    }
    isLoggedIn.value = false
  }

  const login = (user) => {
    setCurrentUser(user)
    isLoggedIn.value = true
  }

  return {
    // çŠ¶æ€
    currentUser,
    isLoggedIn,
    // è®¡ç®—å±æ€§
    userDisplayName,
    // æ–¹æ³•
    setCurrentUser,
    logout,
    login,
  }
})
```

## 4. è·¨åŸŸå¤„ç†

### 4.1 Spring Boot åç«¯ CORS é…ç½®

```java
// åœ¨æ§åˆ¶å™¨ç±»ä¸Šæ·»åŠ æ³¨è§£
@CrossOrigin(origins = "*")
@RestController
@RequestMapping("/api")
public class SleepAnalysisSummaryController {
    // æ§åˆ¶å™¨ä»£ç 
}

// æˆ–è€…å…¨å±€é…ç½®
@Configuration
public class CorsConfig {
    @Bean
    public CorsFilter corsFilter() {
        CorsConfiguration config = new CorsConfiguration();
        config.addAllowedOriginPattern("*");
        config.addAllowedHeader("*");
        config.addAllowedMethod("*");
        config.setAllowCredentials(true);
        
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", config);
        
        return new CorsFilter(source);
    }
}
```

### 4.2 å‰ç«¯ä»£ç†é…ç½®

```javascript
// vite.config.js
export default defineConfig({
  plugins: [vue()],
  server: {
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true,
        rewrite: (path) => path.replace(/^\/api/, '/api')
      }
    }
  }
})
```

## 5. é”™è¯¯å¤„ç†

### 5.1 ç»Ÿä¸€é”™è¯¯å¤„ç†

```javascript
// src/utils/errorHandler.js
export class ErrorHandler {
  static handle(error) {
    console.error('Error:', error)
    
    if (error.response) {
      // æœåŠ¡å™¨å“åº”é”™è¯¯
      const { status, data } = error.response
      switch (status) {
        case 400:
          return 'è¯·æ±‚å‚æ•°é”™è¯¯'
        case 401:
          return 'æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•'
        case 403:
          return 'æ‹’ç»è®¿é—®'
        case 404:
          return 'è¯·æ±‚èµ„æºä¸å­˜åœ¨'
        case 500:
          return 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'
        default:
          return data?.message || `è¯·æ±‚å¤±è´¥ (${status})`
      }
    } else if (error.request) {
      // ç½‘ç»œé”™è¯¯
      return 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ'
    } else {
      // å…¶ä»–é”™è¯¯
      return error.message || 'æœªçŸ¥é”™è¯¯'
    }
  }
}
```

### 5.2 ç»„ä»¶çº§é”™è¯¯å¤„ç†

```vue
<template>
  <div>
    <!-- ç»„ä»¶å†…å®¹ -->
    <div v-if="error" class="error-message">
      {{ error }}
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'
import { useSleepStore } from '@/stores/sleep'

const sleepStore = useSleepStore()
const error = ref(null)

const handleError = (err) => {
  error.value = ErrorHandler.handle(err)
  setTimeout(() => {
    error.value = null
  }, 5000)
}
</script>
```

## 6. æ•°æ®æµè½¬

### 6.1 æ•°æ®æµå‘å›¾

```
ç”¨æˆ·æ“ä½œ â†’ ç»„ä»¶ â†’ Store â†’ API â†’ åç«¯æ¥å£ â†’ æ•°æ®åº“
    â†“
å“åº”æ•°æ® â† ç»„ä»¶ â† Store â† API â† åç«¯æ¥å£ â† æ•°æ®åº“
```

### 6.2 å…·ä½“æµç¨‹ç¤ºä¾‹

```javascript
// 1. ç”¨æˆ·åœ¨ç»„ä»¶ä¸­è§¦å‘æ“ä½œ
const handleRefresh = async () => {
  try {
    // 2. è°ƒç”¨Storeæ–¹æ³•
    await sleepStore.fetchSleepData(userId.value, dateOfSleep.value)
    
    // 3. Storeå†…éƒ¨è°ƒç”¨API
    const response = await sleepApi.getSleepData(userId, dateOfSleep)
    
    // 4. APIå‘é€HTTPè¯·æ±‚åˆ°åç«¯
    // GET /api/sleep/data?userId=user001&date=2024-01-01
    
    // 5. åç«¯å¤„ç†è¯·æ±‚å¹¶è¿”å›æ•°æ®
    // 6. å‰ç«¯æ¥æ”¶å“åº”å¹¶æ›´æ–°çŠ¶æ€
    sleepData.value = response.data
    
    // 7. ç»„ä»¶å“åº”å¼æ›´æ–°UI
  } catch (error) {
    // 8. é”™è¯¯å¤„ç†
    handleError(error)
  }
}
```

## 7. æœ€ä½³å®è·µ

### 7.1 API è®¾è®¡åŸåˆ™

1. **ç»Ÿä¸€å“åº”æ ¼å¼**:
   ```javascript
   {
     "code": 200,
     "message": "æ“ä½œæˆåŠŸ",
     "data": {}
   }
   ```

2. **RESTful è®¾è®¡**:
   - GET: æŸ¥è¯¢æ•°æ®
   - POST: åˆ›å»ºæ•°æ®
   - PUT: æ›´æ–°æ•°æ®
   - DELETE: åˆ é™¤æ•°æ®

3. **å‚æ•°éªŒè¯**:
   - å‰ç«¯å‚æ•°æ ¡éªŒ
   - åç«¯å‚æ•°æ ¡éªŒ
   - ç»Ÿä¸€é”™è¯¯å¤„ç†

### 7.2 çŠ¶æ€ç®¡ç†æœ€ä½³å®è·µ

1. **å•ä¸€æ•°æ®æº**:
   - æ¯ä¸ªæ•°æ®åªåœ¨ä¸€ä¸ªStoreä¸­ç®¡ç†
   - é¿å…æ•°æ®é‡å¤å’ŒåŒæ­¥é—®é¢˜

2. **å“åº”å¼æ›´æ–°**:
   - ä½¿ç”¨computedå±æ€§å¤„ç†è¡ç”Ÿæ•°æ®
   - ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§å’Œå®æ—¶æ€§

3. **é”™è¯¯è¾¹ç•Œ**:
   - åœ¨Storeå±‚ç»Ÿä¸€å¤„ç†é”™è¯¯
   - æä¾›å‹å¥½çš„é”™è¯¯æç¤º

### 7.3 æ€§èƒ½ä¼˜åŒ–

1. **è¯·æ±‚ç¼“å­˜**:
   ```javascript
   const cache = new Map()
   
   const fetchData = async (key) => {
     if (cache.has(key)) {
       return cache.get(key)
     }
     
     const data = await api.getData(key)
     cache.set(key, data)
     return data
   }
   ```

2. **é˜²æŠ–å¤„ç†**:
   ```javascript
   import { debounce } from 'lodash-es'
   
   const debouncedSearch = debounce(async (query) => {
     await searchApi.search(query)
   }, 300)
   ```

3. **åŠ è½½çŠ¶æ€ç®¡ç†**:
   ```javascript
   const loading = ref(false)
   
   const fetchData = async () => {
     if (loading.value) return // é˜²æ­¢é‡å¤è¯·æ±‚
     
     loading.value = true
     try {
       await api.getData()
     } finally {
       loading.value = false
     }
   }
   ```

### 7.4 ä»£ç ç»„ç»‡

1. **APIå±‚**:
   - æŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç»„
   - ç»Ÿä¸€é”™è¯¯å¤„ç†
   - å‚æ•°ç±»å‹å®šä¹‰

2. **Storeå±‚**:
   - å•ä¸€èŒè´£åŸåˆ™
   - çŠ¶æ€å’ŒåŠ¨ä½œåˆ†ç¦»
   - è®¡ç®—å±æ€§ä¼˜åŒ–

3. **ç»„ä»¶å±‚**:
   - æœ€å°åŒ–çŠ¶æ€
   - äº‹ä»¶é©±åŠ¨
   - å¯å¤ç”¨æ€§

## 8. è°ƒè¯•æŠ€å·§

### 8.1 ç½‘ç»œè¯·æ±‚è°ƒè¯•

```javascript
// åœ¨request.jsä¸­æ·»åŠ è°ƒè¯•ä¿¡æ¯
request.interceptors.request.use((config) => {
  console.log('ğŸš€ è¯·æ±‚:', {
    url: config.url,
    method: config.method,
    params: config.params,
    data: config.data
  })
  return config
})

request.interceptors.response.use((response) => {
  console.log('âœ… å“åº”:', {
    url: response.config.url,
    status: response.status,
    data: response.data
  })
  return response
})
```

### 8.2 StoreçŠ¶æ€è°ƒè¯•

```javascript
// åœ¨Storeä¸­æ·»åŠ è°ƒè¯•æ–¹æ³•
const debugState = () => {
  console.log('ğŸ” StoreçŠ¶æ€:', {
    sleepData: sleepData.value,
    loading: loading.value,
    error: error.value
  })
}

// åœ¨ç»„ä»¶ä¸­è°ƒç”¨
const sleepStore = useSleepStore()
sleepStore.debugState()
```

### 8.3 é”™è¯¯è¿½è¸ª

```javascript
// å…¨å±€é”™è¯¯å¤„ç†
window.addEventListener('unhandledrejection', (event) => {
  console.error('æœªå¤„ç†çš„Promiseæ‹’ç»:', event.reason)
  // å¯ä»¥å‘é€åˆ°é”™è¯¯ç›‘æ§æœåŠ¡
})

// Vueé”™è¯¯å¤„ç†
app.config.errorHandler = (err, instance, info) => {
  console.error('Vueé”™è¯¯:', err, info)
  // å¯ä»¥å‘é€åˆ°é”™è¯¯ç›‘æ§æœåŠ¡
}
```

## æ€»ç»“

é€šè¿‡ä»¥ä¸Šé…ç½®ï¼ŒVue3å‰ç«¯ä¸Spring Bootåç«¯å¯ä»¥å®ç°ï¼š

1. **æ— ç¼å¯¹æ¥**: ç»Ÿä¸€çš„APIæ¥å£å’Œå“åº”æ ¼å¼
2. **çŠ¶æ€ç®¡ç†**: Piniaæä¾›å“åº”å¼çŠ¶æ€ç®¡ç†
3. **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º
4. **æ€§èƒ½ä¼˜åŒ–**: è¯·æ±‚ç¼“å­˜ã€é˜²æŠ–ã€åŠ è½½çŠ¶æ€ç®¡ç†
5. **å¼€å‘ä½“éªŒ**: ç±»å‹å®‰å…¨ã€è°ƒè¯•å‹å¥½ã€ä»£ç ç»„ç»‡æ¸…æ™°

è¿™å¥—æ¶æ„å¯ä»¥æ”¯æŒå¤æ‚çš„ç¡çœ å¥åº·ç®¡ç†åº”ç”¨ï¼Œæä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒå’Œå¼€å‘ä½“éªŒã€‚
